<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Elegir tipo y abogado</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding-top: 56px; } /* si tienes navbar fijo */
    .container-main { max-width: 1100px; margin: 0 auto; padding: 2rem 1rem; }
    .tipo-group .btn { text-align: left; }
    .card-lawyer { cursor: pointer; transition: .15s ease; }
    .card-lawyer.selected { border: 2px solid #0d6efd; box-shadow: 0 8px 24px rgba(13,110,253,0.12); transform: translateY(-4px); }
    .avatar-law { width:72px; height:72px; object-fit:cover; border-radius:8px; }
    .phone-small { font-size: .9rem; color:#0d6efd; }
    .hint { font-size:.9rem; color:#6c757d; }
  </style>
</head>
<body>

  <!-- Opcional: navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">DesvelandoAbusos.pe</a>
    </div>
  </nav>

  <main class="container-main">
    <div class="row g-4">
      <div class="col-12">
        <h3 class="mb-1">Tipo de denuncia</h3>
        <p class="hint mb-3">Selecciona el tipo de hecho que quieres denunciar.</p>

        <!-- Tipos (pueden ser radio buttons estilizados) -->
        <div class="btn-group w-100 mb-3 tipo-group" role="group" aria-label="Tipos">
          <input type="radio" class="btn-check" name="tipo" id="tipo1" autocomplete="off" value="Coimas / Sobornos" checked>
          <label class="btn btn-outline-primary" for="tipo1">Coimas / Sobornos</label>

          <input type="radio" class="btn-check" name="tipo" id="tipo2" autocomplete="off" value="Malversación">
          <label class="btn btn-outline-primary" for="tipo2">Malversación</label>

          <input type="radio" class="btn-check" name="tipo" id="tipo3" autocomplete="off" value="Nepotismo">
          <label class="btn btn-outline-primary" for="tipo3">Nepotismo</label>

          <input type="radio" class="btn-check" name="tipo" id="tipo4" autocomplete="off" value="Tráfico de influencias">
          <label class="btn btn-outline-primary" for="tipo4">Tráfico de influencias</label>

          <input type="radio" class="btn-check" name="tipo" id="tipo5" autocomplete="off" value="Otro">
          <label class="btn btn-outline-primary" for="tipo5">Otro</label>
        </div>
      </div>

      <div class="col-12">
        <h5 class="mb-2">Elige un abogado</h5>
        <p class="hint mb-3">Haz clic en la tarjeta para seleccionar un único abogado. Luego presiona "Continuar".</p>

        <!-- Grid de abogados -->
        <div id="lawyersGrid" class="row g-3">
          <!-- Las tarjetas se generan desde JS -->
        </div>
      </div>

      <div class="col-12 d-flex justify-content-between align-items-center mt-3">
        <a href="login.html" class="btn btn-outline-secondary">Volver</a>
        <button id="btnContinuar" class="btn btn-primary">Continuar</button>
      </div>
    </div>
  </main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Datos de ejemplo de abogados (puedes reemplazar por datos reales)
  const lawyers = [
    { id: 'a1', name: 'Dra. Ana Pérez', phone: '+51 987 654 321', img: 'https://randomuser.me/api/portraits/women/68.jpg' },
    { id: 'a2', name: 'Dr. Juan Torres', phone: '+51 912 345 678', img: 'https://randomuser.me/api/portraits/men/45.jpg' },
    { id: 'a3', name: 'Dra. Carmen Díaz', phone: '+51 999 111 222', img: 'https://randomuser.me/api/portraits/women/44.jpg' },
    { id: 'a4', name: 'Dr. Luis Mendoza', phone: '+51 944 222 333', img: 'https://randomuser.me/api/portraits/men/12.jpg' }
  ];

  const grid = document.getElementById('lawyersGrid');

  // Render cards
  lawyers.forEach(l => {
    const col = document.createElement('div');
    col.className = 'col-12 col-md-6 col-lg-4';

    col.innerHTML = `
      <div class="card card-lawyer p-2 h-100" data-id="${l.id}" role="button" tabindex="0" aria-pressed="false">
        <div class="d-flex gap-3 align-items-center">
          <img src="${l.img}" alt="${l.name}" class="avatar-law">
          <div>
            <div class="fw-bold">${l.name}</div>
            <div class="phone-small mt-1"><a href="tel:${l.phone.replace(/\s+/g,'')}" class="text-decoration-none">${l.phone}</a></div>
            <div class="text-muted small">Especialista en casos de corrupción</div>
          </div>
        </div>
      </div>
    `;
    grid.appendChild(col);
  });

  // Manejo de selección única
  let selectedLawyerId = null;
  grid.addEventListener('click', (ev) => {
    const card = ev.target.closest('.card-lawyer');
    if (!card) return;
    selectCard(card.dataset.id);
  });

  // también soporte teclado (enter)
  grid.addEventListener('keydown', (ev) => {
    if (ev.key === 'Enter') {
      const card = ev.target.closest('.card-lawyer');
      if (card) selectCard(card.dataset.id);
    }
  });

  function selectCard(id) {
    // deseleccionar previo
    document.querySelectorAll('.card-lawyer').forEach(c => {
      c.classList.remove('selected');
      c.setAttribute('aria-pressed','false');
    });
    // seleccionar nuevo
    const el = document.querySelector(`.card-lawyer[data-id="${id}"]`);
    if (el) {
      el.classList.add('selected');
      el.setAttribute('aria-pressed','true');
      selectedLawyerId = id;
    } else {
      selectedLawyerId = null;
    }
  }

  // Botón continuar
  document.getElementById('btnContinuar').addEventListener('click', () => {
    // obtener tipo seleccionado
    const tipo = document.querySelector('input[name="tipo"]:checked')?.value || null;
    if (!tipo) {
      alert('Selecciona un tipo de denuncia.');
      return;
    }
    if (!selectedLawyerId) {
      alert('Selecciona un abogado.');
      return;
    }

    // recuperar usuario guardado
    const usuario = JSON.parse(localStorage.getItem('denuncia_usuario') || 'null');
    if (!usuario) {
      alert('No hay usuario registrado. Regresa e ingresa tus datos.');
      window.location.href = 'login.html';
      return;
    }

    // armar objeto de "resumen" (aquí solo simulamos guardar)
    const abogado = lawyers.find(l => l.id === selectedLawyerId);
    const resumen = {
      usuario,
      tipo,
      abogado,
      creado: new Date().toISOString()
    };

    // guardar temporalmente (demo)
    localStorage.setItem('denuncia_seleccion', JSON.stringify(resumen));

    // En un flujo real, aquí dirigirías al formulario de denuncia (con más campos)
    // Para la demo mostraremos un confirm y (opcional) ir a index.html
    alert('Seleccion guardada. Continuando...\n\n' + JSON.stringify(resumen, null, 2));
    // window.location.href = 'form_denuncia.html'; // ejemplo
  });

  // Si quieres, auto-seleccionar el primer abogado
  // selectCard(lawyers[0].id);
</script>
</body>
</html>
